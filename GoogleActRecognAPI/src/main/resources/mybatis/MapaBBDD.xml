<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.googleActRecognDataServer.api.postgres.ServicioPostgreSQL">

	<insert id="nuevaActividad" parameterType="map">
		INSERT INTO
		actividad
		(actividad, coeficiente, _timestamp, "advIdCliente", "insIdCliente",
		bandera)
		VALUES
		(#{actividad.actividad}, #{actividad.coeficiente},
		now(),
		#{ids.advIdCliente}, #{ids.insIdCliente}, #{bandera})
	</insert>

	<insert id="nuevoIdCliente" parameterType="map">
		INSERT INTO
		cliente
		("advIdCliente", "insIdCliente")
		VALUES
		(#{ids.advIdCliente},
		#{ids.insIdCliente})
	</insert>

	<!-- ************** READ ************** -->

	<select id="cogerActividadesUltimoDia" 
		resultType="com.googleActRecognDataServer.api.postgres.pojos.ActividadBandera">
		SELECT actividad, bandera, _timestamp
		FROM actividad
		WHERE
		((current_timestamp::timestamp-
		_timestamp::timestamp) &lt;= interval
		'10' day) AND (coeficiente &gt;= 70)
		;
	</select>

	<select id="cogerActividadesUltimoDiaDeCliente" parameterType="map"
		resultType="com.googleActRecognDataServer.api.postgres.pojos.ActividadBandera">
		SELECT actividad, bandera, _timestamp
		FROM actividad
		WHERE
		((current_timestamp::timestamp-
		_timestamp::timestamp) &lt;= interval
		'10' day) AND (coeficiente &gt;= 70) AND ("advIdCliente" =
		#{ids.advIdCliente}) AND ("insIdCliente" = #{ids.insIdCliente})
		;
	</select>

	<select id="cogerTodosClientes"
		resultType="com.googleActRecognDataServer.api.postgres.pojos.IdsCliente">
		SELECT *
		FROM cliente;
	</select>

</mapper>
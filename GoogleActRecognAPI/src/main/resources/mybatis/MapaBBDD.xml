<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.googleActRecognDataServer.api.postgres.PostgreSQLService">

	<insert id="nuevaActividad" parameterType="map">
		INSERT INTO
		actividad
		(actividad, coeficiente, _timestamp, "advIdCliente", "insIdCliente")
		VALUES
		(#{actividad.actividad}, #{actividad.coeficiente},
		now(),
		#{ids.advIdCliente}, #{ids.insIdCliente})
	</insert>

	<insert id="nuevoIdCliente" parameterType="map">
		INSERT INTO
		cliente
		("advIdCliente", "insIdCliente")
		VALUES
		(#{ids.advIdCliente},
		#{ids.insIdCliente})
	</insert>

	<!-- ************** READ ************** -->
	<select id="cogerUltimaActividadPorIds"
		resultType="com.googleActRecognDataServer.api.postgres.pojos.ActividadGoogle">
		SELECT actividad, coeficiente
		FROM actividad
		WHERE
		"advIdCliente" = #{ids.advIdCliente} AND
		"insIdCliente" =
		#{ids.insIdCliente} AND date_trunc('second',cast(_timestamp
		as time)) =
		(SELECT date_trunc('second',cast(_timestamp as time)) FROM
		actividad
		ORDER BY _timestamp DESC LIMIT 1);
	</select>
	
	<!-- <select id="getUnaPrueba" resultType="com.googleActRecognDataServer.api.postgres.pojos.Prueba"> 
		SELECT * FROM "tPrueba" WHERE nombre=#{nombre}; </select> -->



</mapper>